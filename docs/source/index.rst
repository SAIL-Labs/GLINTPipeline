.. doc_glint_pipeline documentation master file, created by
   sphinx-quickstart on Mon Oct 21 15:40:36 2019.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Documentation of GLINT Pipeline
===============================

GLINT Pipeline is a set of scripts and classes used to estimate the null depth from raw data
and put it in a nice format.

Raw data consists in matlab files containing cube of frames of 344x96 pixels (height x width).
Each frame contains 16 outputs (4 photometric, 6 null and 6 antinull ones) stack one above the other and
spectrally dispersed along the width axis of the frame.

:doc:`glint_classes` is the library of the pipeline to deal with raw data and feed the model fitting algorithm.

:doc:`glint_dark` processes the dark frames.

:doc:`glint_measure_null_depth` extracts null depths and intensities from data and dark frames.
The outputs are used in the model fitting script.

:doc:`glint_geometric_calibration` is for calibration purpose. 
It returns the shape and location of the 16 outputs respect to the wavelength.

:doc:`glint_spectral_calibration` performs a spectral calibration for each one of the 16 outputs.

:doc:`glint_zeta_coeff` determines the intensity ratios between the interferometric outputs and their related photometric ones.

The source can be found `on Github`_.

.. _on Github: https://github.com/SydneyAstrophotonicInstrumentationLab/GLINTPipeline

Navigation
==========
.. toctree::
   :maxdepth: 2

   glint_classes
   glint_dark
   glint_measure_null_depth
   glint_geometric_calibration
   glint_spectral_calibration
   glint_zeta_coeff

Glossary
========
* **data**: acquired data, called by a script. Can be raw or preprocessed.
* **product**: data generated by a script and can be used by other scripts.

How to use the pipeline
=======================
First time use
--------------
The calibration products do not exist.
Data needed:

* dark frames
* spectral data: data acquired with a tunable spectral source. One set (e.g. folder) of frames per wavelength. The name of the folder must contain the wavelength
* geometric data: no fringe data. Obtained either with OPD out of the coherent length or by blurring the fringes
* data with individual beam active. Obtained by moving the mask to be sure that **one** and only **one** beam is active. Be careful with cross-talk and wiggles. The name of the files must contain the keyword ``pX`` with X=1..4 the id of the beam.

Run the script in the following order:

1. :doc:`glint_dark`
2. :doc:`glint_geometric_calibration`
3. :doc:`glint_spectral_calibration`
4. :doc:`glint_zeta_coeff`

For sanity, step 2 should be run for every observation session.

Routine use
-------------
The calibration product exist.
Data needed:

* dark frames
* science frames (lab or on-sky)

Run the script in the following order:

1. :doc:`glint_dark`
2. :doc:`glint_geometric_calibration`
3. :doc:`glint_measure_null_depth` with dark frames
4. :doc:`glint_measure_null_depth` with data frames
5. Feed the model fitting script with the products


Indices and tables
==================

* :ref:`genindex`
* :ref:`modindex`
* :ref:`search`
